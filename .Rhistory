,'Strong'
,'Quite Strong')))
levels(datos$Type.of.Walls)
#---------------------------------------------------------------------------------------------------------------------------------------------
levels(datos$Toilet.Facilities)
summary(datos$Toilet.Facilities)
datos$Toilet.Facilities=
factor(datos$Toilet.Facilities,ordered=TRUE,levels=
(c('None'
,'Others'
,'Open pit'
,'Closed pit'
,'Water-sealed, other depository, shared with other household'
,'Water-sealed, other depository, used exclusively by household'
,'Water-sealed, sewer septic tank, shared with other household'
,'Water-sealed, sewer septic tank, used exclusively by household')))
levels(datos$Toilet.Facilities)
#---------------------------------------------------------------------------------------------------------------------------------------------
levels(datos$Household.Head.Occupation)
#---------------------------------------------------------------------------------------------------------------------------------------------
levels(datos$Main.Source.of.Water.Supply)
datos$Main.Source.of.Water.Supply=
factor(datos$Main.Source.of.Water.Supply,ordered=TRUE,levels=
(c('Others'
,'Dug well'
,'Lake, river, rain and others'
,'Unprotected spring, river, stream, etc'
,'Protected spring, river, stream, etc'
,'Tubed/piped shallow well'
,'Shared, tubed/piped deep well'
,'Own use, tubed/piped deep well'
,'Peddler'
,'Shared, faucet, community water system'
,'Own use, faucet, community water system')))
levels(datos$Main.Source.of.Water.Supply)
#---------------------------------------------------------------------------------------------------------------------------------------------
levels(datos$Tenure.Status)
datos$Tenure.Status[which(datos$Tenure.Status=='Not Applicable')] <-NA # Se etiqueta como NA el valor "Not Applicable" (no aplicable)
datos$Tenure.Status<-fct_drop(datos$Tenure.Status)
levels(datos$Tenure.Status)
summary(datos$Tenure.Status)
#---------------------------------------------------------------------------------------------------------------------------------------------
levels(datos$Electricity)
summary(datos$Electricity)
ggplot(datos, aes(x=Number.of.Airconditioner,fill= Electricity)) + geom_bar(position = "dodge")
# Sustitución de 0/1 por No/Si
datos$Electricity[which(datos$Electricity=='0')] <- 'No'
datos$Electricity[which(datos$Electricity=='1')] <- 'Si'
# Transformación de la variable Electricity a categórica, por ser binaria (0 o 1 / No o Si)
datos$Electricity<-as.factor(datos$Electricity)
datos$Electricity =
factor(datos$Electricity,ordered=TRUE,levels=
(c('No','Si')))
#---------------------------------------------------------------------------------------------------------------------------------------------
levels(datos$Number.of.bedrooms)
summary(datos$Number.of.bedrooms)
#---------------------------------------------------------------------------------------------------------------------------------------------
levels(datos$Number.of.Refrigerator.Freezer)
summary(datos$Number.of.Refrigerator.Freezer)
#---------------------------------------------------------------------------------------------------------------------------------------------
levels(datos$Number.of.Washing.Machine)
summary(datos$Number.of.Washing.Machine)
#---------------------------------------------------------------------------------------------------------------------------------------------
levels(datos$Number.of.Airconditioner)
summary(datos$Number.of.Airconditioner)
#---------------------------------------------------------------------------------------------------------------------------------------------
levels(datos$Number.of.Car..Jeep..Van)
summary(datos$Number.of.Car..Jeep..Van)
#---------------------------------------------------------------------------------------------------------------------------------------------
levels(datos$Number.of.CD.VCD.DVD)
summary(datos$Number.of.CD.VCD.DVD)
#---------------------------------------------------------------------------------------------------------------------------------------------
levels(datos$Number.of.Cellular.phone)
summary(datos$Number.of.Cellular.phone)
#---------------------------------------------------------------------------------------------------------------------------------------------
levels(datos$Number.of.Component.Stereo.set)
summary(datos$Number.of.Component.Stereo.set)
#---------------------------------------------------------------------------------------------------------------------------------------------
levels(datos$Number.of.Landline.wireless.telephones)
summary(datos$Number.of.Landline.wireless.telephones)
#---------------------------------------------------------------------------------------------------------------------------------------------
levels(datos$Number.of.Personal.Computer)
summary(datos$Number.of.Personal.Computer)
#---------------------------------------------------------------------------------------------------------------------------------------------
levels(datos$Number.of.Motorcycle.Tricycle)
summary(datos$Number.of.Motorcycle.Tricycle)
#---------------------------------------------------------------------------------------------------------------------------------------------
levels(datos$Number.of.Stove.with.Oven.Gas.Range)
summary(datos$Number.of.Stove.with.Oven.Gas.Range)
#---------------------------------------------------------------------------------------------------------------------------------------------
levels(datos$Number.of.Television)
summary(datos$Number.of.Television)
#---------------------------------------------------------------------------------------------------------------------------------------------
levels(datos$Number.of.Motorized.Banca)
summary(datos$Number.of.Motorized.Banca)
#---------------------------------------------------------------------------------------------------------------------------------------------
# ----- Creación de una muestra del conjunto inicial de datos con muestreo aleatorio simple sin reemplazamiento -----
set.seed(300)
datos_s <- datos %>%
sample_n(size=10000,replace=FALSE)
# División de la muestra de 10000 observaciones en dos conjuntos: uno de train y otro de test (70%-30%)
training <- createDataPartition(pull(datos_s, Total.Household.Income ),
p = 0.7, list = FALSE, times = 1)
datos_training <- slice(datos_s, training)
datos_testing <- slice(datos_s, -training)
var_train_cat <- datos_training%>%select_if(is.factor)
var_train_num <- datos_training%>%select_if(is.numeric)
CrossTable(var_train_cat$Region, var_train_cat$Electricity, prop.chisq = FALSE)
CrossTable(var_train_cat$Household.Head.Class.of.Worker, var_train_cat$Number.of.Stove.with.Oven.Gas.Range, prop.chisq = FALSE)
# ----- Estudio de frecuencias multidimensionales -----
# Análisis de la variable electricity/región/sexo
ftable(var_train_cat$Region, var_train_cat$Household.Head.Sex, var_train_cat$Electricity)
# ----- Gráficos EDA con variables cualitativas individuales -----
ggplot(datos, aes(Region)) + geom_bar() + ggtitle("Núm. familias. por Región") + theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(datos, aes(Main.Source.of.Income)) + geom_bar() + ggtitle("Núm. familias. por fuente de ingresos")
# ----- Visualización de datos cualitativos -----
barplot(table(datos$Region), col = c("lightblue","yellow", "cadetblue4"),
main = "Diagrama de barras de las frecuencias absolutas\n de la variable \"Region\"")
barplot(table(datos$Household.Head.Sex, datos$Electricity),
beside = T,
col = c("yellow", "lightblue"),
names = c("Women", "Men"),
legend.text = c("No", "Yes"))
barplot(prop.table(table(datos$Household.Head.Class.of.Worker,datos$Main.Source.of.Income)),
beside = TRUE, col = c("chocolate","cornsilk1","cornflowerblue","blueviolet", "darkgoldenrod1", "coral", "brown", "chartreuse4"),
legend.text = T, main = "Frecuencias relativas de fuente de\n ingresos por tipo de trabajo",
ylim = c(0,1))
# Histograma de las variables cuantitativas sin transformar
summary(var_train_num$Total.Household.Income)
qplot(var_train_num$Total.Household.Income,
geom="histogram",
binwidth = 10000,
main = "Histogram for Total Household Income",
xlab = "Total Household Income",
fill=I("blue"),
col=I("red"),
xlim=c(10000,12000000))
summary(var_train_num$Total.Food.Expenditure)
qplot(var_train_num$Total.Food.Expenditure,
geom="histogram",
binwidth = 10000,
main = "Histogram for Total Food Expenditure",
xlab = "Total Food Expenditure",
fill=I("blue"),
col=I("red"),
xlim=c(2000,800000))
summary(var_train_num$Bread.and.Cereals.Expenditure)
qplot(var_train_num$Bread.and.Cereals.Expenditure,
geom="histogram",
binwidth = 1000,
main = "Histogram for Bread.and.Cereals.Expenditure",
xlab = "Bread.and.Cereals.Expenditure",
fill=I("blue"),
col=I("red"),
xlim=c(-1000,350000))
summary(var_train_num$Total.Rice.Expenditure)
qplot(var_train_num$Total.Rice.Expenditure,
geom="histogram",
binwidth = 1000,
main = "Histogram for Total Rice Expenditure",
xlab = "Total Rice Expenditure",
fill=I("blue"),
col=I("red"),
xlim=c(-1000,350000))
summary(var_train_num$Meat.Expenditure)
qplot(var_train_num$Meat.Expenditure,
geom="histogram",
binwidth = 1000,
main = "Histogram for Meat.Expenditure",
xlab = "Meat.Expenditure",
fill=I("blue"),
col=I("red"),
xlim=c(-1000,270000))
summary(var_train_num$Total.Fish.and..marine.products.Expenditure)
qplot(var_train_num$Total.Fish.and..marine.products.Expenditure,
geom="histogram",
binwidth = 1000,
main = "Histogram for Total.Fish.and..marine.products.Expenditure",
xlab = "Total.Fish.and..marine.products.Expenditure",
fill=I("blue"),
col=I("red"),
xlim=c(-1000,190000))
summary(var_train_num$Fruit.Expenditure)
qplot(var_train_num$Fruit.Expenditure,
geom="histogram",
binwidth = 1000,
main = "Histogram for Fruit.Expenditure",
xlab = "Fruit.Expenditure",
fill=I("blue"),
col=I("red"),
xlim=c(-1000,70000))
summary(var_train_num$Vegetables.Expenditure)
qplot(var_train_num$Vegetables.Expenditure,
geom="histogram",
binwidth = 1000,
main = "Histogram for Vegetables.Expenditure",
xlab = "Vegetables.Expenditure",
fill=I("blue"),
col=I("red"),
xlim=c(-1000,80000))
summary(var_train_num$Restaurant.and.hotels.Expenditure)
qplot(var_train_num$Restaurant.and.hotels.Expenditure,
geom="histogram",
binwidth = 5000,
main = "Histogram for Restaurant.and.hotels.Expenditure",
xlab = "Restaurant.and.hotels.Expenditure",
fill=I("blue"),
col=I("red"),
xlim=c(-5000,520000))
summary(var_train_num$Alcoholic.Beverages.Expenditure)
qplot(var_train_num$Alcoholic.Beverages.Expenditure,
geom="histogram",
binwidth = 1000,
main = "Histogram for Alcoholic.Beverages.Expenditure",
xlab = "Alcoholic.Beverages.Expenditure",
fill=I("blue"),
col=I("red"),
xlim=c(-1000,36000))
summary(var_train_num$Tobacco.Expenditure)
qplot(var_train_num$Tobacco.Expenditure,
geom="histogram",
binwidth = 1000,
main = "Histogram for Tobacco.Expenditure",
xlab = "Tobacco.Expenditure",
fill=I("blue"),
col=I("red"),
xlim=c(-1000,100000))
summary(var_train_num$Clothing..Footwear.and.Other.Wear.Expenditure)
qplot(var_train_num$Clothing..Footwear.and.Other.Wear.Expenditure,
geom="histogram",
binwidth = 10000,
main = "Histogram for Clothing..Footwear.and.Other.Wear.Expenditure",
xlab = "Clothing..Footwear.and.Other.Wear.Expenditure",
fill=I("blue"),
col=I("red"),
xlim=c(-10000,360000))
summary(var_train_num$Housing.and.water.Expenditure)
qplot(var_train_num$Housing.and.water.Expenditure,
geom="histogram",
binwidth = 10000,
main = "Histogram for Housing.and.water.Expenditure",
xlab = "Housing.and.water.Expenditure",
fill=I("blue"),
col=I("red"),
xlim=c(2000,842000))
summary(var_train_num$Imputed.House.Rental.Value)
qplot(var_train_num$Imputed.House.Rental.Value,
geom="histogram",
binwidth = 1000,
main = "Histogram for Imputed.House.Rental.Value",
xlab = "Imputed.House.Rental.Value",
fill=I("blue"),
col=I("red"),
xlim=c(-1000,730000))
summary(var_train_num$Medical.Care.Expenditure)
qplot(var_train_num$Medical.Care.Expenditure,
geom="histogram",
binwidth = 10000,
main = "Histogram for Medical.Care.Expenditure",
xlab = "Medical.Care.Expenditure",
fill=I("blue"),
col=I("red"),
xlim=c(-10000,1000000))
summary(var_train_num$Transportation.Expenditure)
qplot(var_train_num$Transportation.Expenditure,
geom="histogram",
binwidth = 10000,
main = "Histogram for Transportation.Expenditure",
xlab = "Transportation.Expenditure",
fill=I("blue"),
col=I("red"),
xlim=c(-10000,500000))
summary(var_train_num$Communication.Expenditure)
qplot(var_train_num$Communication.Expenditure,
geom="histogram",
binwidth = 1000,
main = "Histogram for Communication.Expenditure",
xlab = "Communication.Expenditure",
fill=I("blue"),
col=I("red"),
xlim=c(-1000,100000))
summary(var_train_num$Education.Expenditure)
qplot(var_train_num$Education.Expenditure,
geom="histogram",
binwidth = 10000,
main = "Histogram for Education.Expenditure",
xlab = "Education.Expenditure",
fill=I("blue"),
col=I("red"),
xlim=c(-10000,340000))
summary(var_train_num$Miscellaneous.Goods.and.Services.Expenditure)
qplot(var_train_num$Miscellaneous.Goods.and.Services.Expenditure,
geom="histogram",
binwidth = 10000,
main = "Histogram for Miscellaneous.Goods.and.Services.Expenditure",
xlab = "Miscellaneous.Goods.and.Services.Expenditure",
fill=I("blue"),
col=I("red"),
xlim=c(-10000,320000))
summary(var_train_num$Special.Occasions.Expenditure)
qplot(var_train_num$Special.Occasions.Expenditure,
geom="histogram",
binwidth = 10000,
main = "Histogram for Special.Occasions.Expenditure",
xlab = "Special.Occasions.Expenditure",
fill=I("blue"),
col=I("red"),
xlim=c(-10000,310000))
summary(var_train_num$Crop.Farming.and.Gardening.expenses)
qplot(var_train_num$Crop.Farming.and.Gardening.expenses,
geom="histogram",
binwidth = 100000,
main = "Histogram for Crop.Farming.and.Gardening.expenses",
xlab = "Crop.Farming.and.Gardening.expenses",
fill=I("blue"),
col=I("red"),
xlim=c(-100000,3800000))
summary(var_train_num$Total.Income.from.Entrepreneurial.Acitivites)
qplot(var_train_num$Total.Income.from.Entrepreneurial.Acitivites,
geom="histogram",
binwidth = 100000,
main = "Histogram for Total.Income.from.Entrepreneurial.Acitivites",
xlab = "Total.Income.from.Entrepreneurial.Acitivites",
fill=I("blue"),
col=I("red"),
xlim=c(-100000,4800000))
summary(var_train_num$Household.Head.Age)
qplot(var_train_num$Household.Head.Age,
geom="histogram",
binwidth = 5,
main = "Histogram for Household.Head.Age",
xlab = "Household.Head.Age",
fill=I("blue"),
col=I("red"),
xlim=c(10,100))
summary(var_train_num$Total.Number.of.Family.members)
qplot(var_train_num$Total.Number.of.Family.members,
geom="histogram",
binwidth = 1,
main = "Histogram for Total.Number.of.Family.members",
xlab = "Total.Number.of.Family.members",
fill=I("blue"),
col=I("red"),
xlim=c(-1,23))
summary(var_train_num$Total.number.of.family.members.employed)
qplot(var_train_num$Total.number.of.family.members.employed,
geom="histogram",
binwidth = 1,
main = "Histogram for Total.number.of.family.members.employed",
xlab = "Total.number.of.family.members.employed",
fill=I("blue"),
col=I("red"),
xlim=c(-1,10))
summary(var_train_num$House.Floor.Area)
qplot(var_train_num$House.Floor.Area,
geom="histogram",
binwidth = 25,
main = "Histogram for House.Floor.Area",
xlab = "House.Floor.Area",
fill=I("blue"),
col=I("red"),
xlim=c(-25,1000))
summary(var_train_num$House.Age)
qplot(var_train_num$House.Age,
geom="histogram",
binwidth = 5,
main = "Histogram for House.Age",
xlab = "House.Age",
fill=I("blue"),
col=I("red"),
xlim=c(-1,130))
summary(var_train_num$Number.of.bedrooms)
qplot(var_train_num$Number.of.bedrooms,
geom="histogram",
binwidth = 1,
main = "Histogram for Number.of.bedrooms",
xlab = "Number.of.bedrooms",
fill=I("blue"),
col=I("red"),
xlim=c(-1,10))
summary(var_train_num$Number.of.Television)
qplot(var_train_num$Number.of.Television,
geom="histogram",
binwidth = 1,
main = "Histogram for Number.of.Television",
xlab = "Number.of.Television",
fill=I("blue"),
col=I("red"),
xlim=c(-1,7))
summary(var_train_num$Number.of.CD.VCD.DVD)
qplot(var_train_num$Number.of.CD.VCD.DVD,
geom="histogram",
binwidth = 1,
main = "Histogram for Number.of.CD.VCD.DVD",
xlab = "Number.of.CD.VCD.DVD",
fill=I("blue"),
col=I("red"),
xlim=c(-1,7))
summary(var_train_num$Number.of.Component.Stereo.set)
qplot(var_train_num$Number.of.Component.Stereo.set,
geom="histogram",
binwidth = 1,
main = "Histogram for Number.of.Component.Stereo.set",
xlab = "Number.of.Component.Stereo.set",
fill=I("blue"),
col=I("red"),
xlim=c(-1,7))
summary(var_train_num$Number.of.Refrigerator.Freezer)
qplot(var_train_num$Number.of.Refrigerator.Freezer,
geom="histogram",
binwidth = 1,
main = "Histogram for Number.of.Refrigerator.Freezer",
xlab = "Number.of.Refrigerator.Freezer",
fill=I("blue"),
col=I("red"),
xlim=c(-1,7))
summary(var_train_num$Number.of.Washing.Machine)
qplot(var_train_num$Number.of.Washing.Machine,
geom="histogram",
binwidth = 1,
main = "Histogram for Number.of.Washing.Machine",
xlab = "Number.of.Washing.Machine",
fill=I("blue"),
col=I("red"),
xlim=c(-1,5))
summary(var_train_num$Number.of.Airconditioner)
qplot(var_train_num$Number.of.Airconditioner,
geom="histogram",
binwidth = 1,
main = "Histogram for Number.of.Airconditioner",
xlab = "Number.of.Airconditioner",
fill=I("blue"),
col=I("red"),
xlim=c(-1,7))
summary(var_train_num$Number.of.Car..Jeep..Van)
qplot(var_train_num$Number.of.Car..Jeep..Van,
geom="histogram",
binwidth = 1,
main = "Histogram for Number.of.Car..Jeep..Van",
xlab = "Number.of.Car..Jeep..Van",
fill=I("blue"),
col=I("red"),
xlim=c(-1,6))
summary(var_train_num$Number.of.Landline.wireless.telephones)
qplot(var_train_num$Number.of.Landline.wireless.telephones,
geom="histogram",
binwidth = 1,
main = "Histogram for Number.of.Landline.wireless.telephones",
xlab = "Number.of.Landline.wireless.telephones",
fill=I("blue"),
col=I("red"),
xlim=c(-1,7))
summary(var_train_num$Number.of.Cellular.phone)
qplot(var_train_num$Number.of.Cellular.phone,
geom="histogram",
binwidth = 1,
main = "Histogram for Number.of.Cellular.phone",
xlab = "Number.of.Cellular.phone",
fill=I("blue"),
col=I("red"),
xlim=c(-1,12))
summary(var_train_num$Number.of.Personal.Computer)
qplot(var_train_num$Number.of.Personal.Computer,
geom="histogram",
binwidth = 1,
main = "Histogram for Number.of.Personal.Computer",
xlab = "Number.of.Personal.Computer",
fill=I("blue"),
col=I("red"),
xlim=c(-1,8))
summary(var_train_num$Number.of.Stove.with.Oven.Gas.Range)
qplot(var_train_num$Number.of.Stove.with.Oven.Gas.Range,
geom="histogram",
binwidth = 1,
main = "Histogram for Number.of.Stove.with.Oven.Gas.Range",
xlab = "Number.of.Stove.with.Oven.Gas.Range",
fill=I("blue"),
col=I("red"),
xlim=c(-1,4))
summary(var_train_num$Number.of.Motorized.Banca)
qplot(var_train_num$Number.of.Motorized.Banca,
geom="histogram",
binwidth = 1,
main = "Histogram for Number.of.Motorized.Banca",
xlab = "Number.of.Motorized.Banca",
fill=I("blue"),
col=I("red"),
xlim=c(-1,5))
summary(var_train_num$Number.of.Motorcycle.Tricycle)
qplot(var_train_num$Number.of.Motorcycle.Tricycle,
geom="histogram",
binwidth = 1,
main = "Histogram for Number.of.Motorcycle.Tricycle",
xlab = "Number.of.Motorcycle.Tricycle",
fill=I("blue"),
col=I("red"),
xlim=c(-1,7))
# Profesiones más comúnes en Filipinas
by_common_jobs <- datos_training %>%
group_by(Household.Head.Occupation) %>%
summarise(Total = n()) %>%
arrange(desc(Total)) %>%
head(20) %>% ungroup()
View(datos_training)
ggplot(data = by_common_jobs) + geom_bar(mapping = aes(x = Household.Head.Occupation, y = Total), stat = "identity") + labs(title="Trabajos más comunes en familias filipinas") + theme(axis.text.x = element_text(angle = 30, hjust = 1))
# Región y gastos
by_region_educ <- datos_training %>%
group_by(Region, Education.Expenditure, Housing.and.water.Expenditure) %>%
summarise(Total = n()) %>%
arrange(desc(Total)) %>% ungroup()
# Para ver el boxplot es necesario transformar la variable
ggplot(by_region_educ, aes(x=Region, y=Education.Expenditure)) + geom_boxplot(color="black", fill="orange", alpha = 0.6) + scale_y_log10() + labs(title="Gasto de educación por regiones") + theme(axis.text.x = element_text(angle = 30, hjust = 1))
